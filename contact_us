<div id="loading_screen">
    <img alt="loading" src="//kodekloud.s3.amazonaws.com/sites/5447ebb66e6f641987020000/3604f5c26997bea3de504de139debcec/loading.gif"/>
</div>
<div  id="main_content" style="display:none">
    <nav>
        <ul class="breadcrumb">
            <li><a href="/home">Home</a> </li>
            <li class="active">Contact Us</li>
        </ul>
    </nav>
    <div class="page_banner">
        <h2>Contact Us</h2>
    </div>
    <div class="inside_page_content">
        <div class="left_column">
            <img class="inside_banner_image" alt="banner" src="//codecloud.cdn.speedyrails.net/sites/57f7bb6f6e6f647835430000/image/jpeg/1459362056000/insidebanner1.jpg"/>
            <div class="show_mobile">
                <p class="right_column_header">centre information</p>
                <div id="centre_info_container_mobile">
                    <script id="centre_info_template_mobile" type="x-tmpl-mustache/text">
                        <p class="directory_content">{{name}}</p>
                        <p class="directory_content">{{address1}}</p>
                        <p class="directory_content">{{city}}, {{province_state}} {{postal_code}}</p>
                        <br>
            
                    </script>
                </div>
            </div>
            <div id="send_contact_success" class="alert alert-success" role="alert" style="display:none">
              <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
              <span class="sr-only">Success</span>
              Thank you for contacting us. A member from our team will contact you shortly. 
                  
             </div>
             <div id="send_contact_error" class="alert alert-danger" role="alert" style="display:none">
              <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
              <span class="sr-only">Error:</span>
              There was an error when trying to submit your request. Please ensure you have entered a valid email address and subject and please try again.
             </div>
            <form name="contact_form" id="contact_form" method="post">
                <div class="row" style="margin-left:-15px;margin-right:-15px">
                <div class="col-sm-12 col-md-12">
                        <p>We value your feedback. Send us your comments or questions by completing the contact form below.</p>
                    </div>
                    <div class="col-sm-6 col-md-6">
                        <label for="name">Name</label>
                        <input name="name" id="name" class="form-control" type="text" value="" required>
                    </div>
                    <div class="col-sm-6 col-md-6">
                        <label for="email" >E-mail</label>
                        <input name="email" id="email" class="form-control" type="text" value="" required>
                    </div>
                </div>
                <br>
                <div class="row" style="margin-left:-15px;margin-right:-15px">
                    <div class="col-sm-12 col-md-12">
                        <label for="subject">Subject</label>
                        <input name="subject" id="subject" class="form-control" type="text" required>
                    </div>
                </div>
                <br>
                <div class="row" style="margin-left:-15px;margin-right:-15px">
                    <div class="col-sm-12 col-md-12">
                        <label for="message">Message</label>
                        <textarea name="message" id="message" rows="8" class="form-control" required></textarea>
                    </div>
                    <div class="col-sm-12 col-md-12">
                    <br>
                        <label for="enterVerify">Enter the following number below to proceed: <div id="verifyNum"></div></label><br>
                        <input type="hidden" value="701469" id="verifyNumHidden" name="verifyNumHidden" />
                        <input type="text" id="enterVerify" name="enterVerify" />
                    </div>
                </div>
                
                <div class="row" style="margin-left:-15px;margin-right:-15px">
                        <div class="col-sm-12 col-md-12"><br/>
                        <button id="submit" class="btn btn-primary" type="submit">Submit</button>
                    </div>
                </div>
                
                
                
            </form>
        </div>
        <div class="right_column">
            <p class="right_column_header">centre information</p>
            <div id="centre_info_container">
                <script id="centre_info_template" type="x-tmpl-mustache/text">
                    <p class="directory_content">{{name}}</p>
                    <p class="directory_content">{{address1}}</p>
                    <p class="directory_content">{{city}}, {{province_state}} {{postal_code}}</p>
                    <br>
                    <div id="mm_page_content" class="directory_content"></div>
                    
                </script>
                <!--<p class="directory_content"><strong>Stuart Hathaway</strong> -->
                <!--    <br>General Manager-->
                <!--    <br>(905) 878-3900 ext. 202-->
                <!--    <br><a href="mailto:shathaway@bentallkennedy.com">shathaway@bentallkennedy.com</a></p>-->
                <!--    <br>-->
                <!--   <p class="directory_content"><strong>Ryan Mitz </strong> -->
                <!--   <br>Vice President, Commercial Leasing and Sales-->
                <!--   <br>-->
                <!--   Liberty Development Corporation -->
                <!--   <br>905.731.8687 ext. 240 -->
                <!--   <br><a href="mailto:ryan@libertydevelopment.ca" target="_blank">ryan@libertydevelopment.ca</a>-->
                <!--   </p>-->
            </div>
            
            
        </div>
    </div>
</div>
<script>
        function randomgen() {
            var rannumber='';
    		for(ranNum=1; ranNum<=6; ranNum++){
    			rannumber+=Math.floor(Math.random()*10).toString();
    		}
    		$('#verifyNum').html(rannumber);
    		$('#verifyNumHidden').val(rannumber);
    	}
    	randomgen();
      
        
        $('#contact_form').submit(function(e) {

    		if($('#enterVerify').val() == $('#verifyNumHidden').val() ) {
                values = [];
                values = JSON.stringify($('#contact_form').serializeArray());
                e.preventDefault();
                $.ajax({
                    url : "/api/v1/contact_us",
                    type: "POST",
                    data : {authenticity_token: '<%=form_authenticity_token%>' ,
                    form_data:values},
                    success: function(data, textStatus, jqXHR)
                    {
                        $('#send_contact_success').fadeIn();
                        $('#contact_form').find("input[type=text], textarea").val("");
                    },
                    error: function (jqXHR, textStatus, errorThrown)
                    {
                        $('#send_contact_error').fadeIn();
                    }
                });

    		    
    		}
    		else
    		{
    			alert("Please Enter Correct Verification Number");
    			randomgen();
    			e.preventDefault();
    		}
    	});
    $(document).ready(function() {
        function renderAll (){
            var propertyDetails = getPropertyDetails();
            renderPageData('#centre_info_container','#centre_info_template',propertyDetails, 'property_details')
            renderPageData('#centre_info_container_mobile','#centre_info_template_mobile',propertyDetails, 'property_details')
            // prefix = get_prefix();
            var prefix = "//janefinch.mallmaverick.com"
            var pages_json = prefix+"/pages/janefinch-contact-us.json"
            $.getJSON(pages_json).done(function(data) {
                $('#mm_title').html(data.title);
                // $('#mm_title_phone').html(data.title);
                // $('#mm_title_location').html(data.title);
                $('#mm_page_content').html(data.body);
            }).fail(function(jqXHR) {
                if (jqXHR.status == 404) {
                    console.log("Sorry. We cant find the page " + pages_json);
                }
            });
            $("#loading_screen").hide();
            $("#main_content").show();
        }

        function renderPageData(container, template, collection, type){
            var item_list = [];
            var item_rendered = [];
            var template_html = $(template).html();
            Mustache.parse(template_html);   // optional, speeds up future uses
            if (type == "property_details"){
                item_list.push(collection);
                collection = []
                collection = item_list;
            }
            $.each( collection , function( key, val ) {
                var rendered = Mustache.render(template_html,val);
                item_rendered.push(rendered);
    
            });
            
            $(container).show();
            $(container).html(item_rendered.join(''));
        };

        loadMallData(renderAll);  

    
  
    });
    
</script>